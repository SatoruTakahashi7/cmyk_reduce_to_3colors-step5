スクリプト名：cmyk_reduce_to_3colors-step5  
動作環境：MacOS X14.7.6、Illustrator2024（v28.7.7）  
開発環境：Mac Studio (2022)  
開発言語：JavaScript(ChatGPTによる）  


## 何をするスクリプトか？  
adobe illustratorのスクリプト。  
CMYKのカラー値がCMYK4色入っている場合、それをCMYの中の2色とK1色の合計3色で、似た色に置き換えたいです。  
選択しているオブジェクトのみです。  

対象となるカラーの条件。  
CMYK の4色すべてが 0 以上で、そのうち3色に変換したい。  
たとえば (C=10, M=15, Y=5, K=20) のように C/M/Y/K のすべてが<0の場合に、CMYのうち2色だけ残し、  
K はそのまま残すというよりも、視覚的に同じ色に見えるように調整するイメージです。   
どのチャンネルを削除するかのロジック 「似た色合いをなるべく保ちつつCMYK4色を3色に落としたい」ので、CMYのうち1色だけ落とすロジック を色相に基づく計算を基準で決める。  
選択しているオブジェクトのみ これは Illustrator 上で現在選択しているパスアイテムやテキストなどのオブジェクトすべてに対して処理をかける。  
Fill（塗り）も、Stroke（線）も変更したい 塗りか線かの扱い 「塗り」「線」の両方を変換する必要あり。   
具体的な期待結果 例えば (C=10, M=15, Y=5, K=20) で最小値 Y=5 を 0 にすると (C=10, M=15, Y=0, K=20) になります。  
すると印刷での見た目はやや赤み＋黒寄りになります。これでは問題あります。   
それとももう少し「なるべく近い色合い」をキープしたい場合、単純に Y を 0 にするだけでは色差が大きくなる場合もあります。  
厳密に色差を小さくしたいならば、他の色の値も、K（ブラック）の値も微調整しています。  
ただ、数値を詳細に取り出してみると、厳密にピッタリな数字になっていないようです。  

最終的なゴール  
上記のような単純なルール（CMYのうち1色を0にして残り2色＋Kで運用）を使った、  
Illustrator用スクリプト（JavaScript / ExtendScript）。  

Kが０の場合は、それをCMYの中の2色だけ、もしくはK1色も入れて合計3色で、似た色に置き換え。  
K=0 かつ C>0, M>0, Y>0 の場合、 (C,M,Y,0) のまま(ΔE=0) ではなくて、どれかを0にして、Kを足す。  

## 使用条件  
このスクリプトが正常に動作する環境は以下の通りです。  
-MacOS X14.7.6  
-Illustrator2024（v28.7.7）  


##インストール  
スクリプト本体（cmyk_reduce_to_3colors-step5.jsx）を  
~/Applications/Adobe Illustrator 2024/Presets.localized/ja_JP/スクリプト  
にコピーしてください。エイリアスを入れておくだけでもかまいません。  

## 免責事項  
-本アプリケーションはIllustratorにおける作業効率支援なのであって、処理結果を保証するものではありません。かならず確認をされることをおすすめします。  
-このツールを使用する上でデータの破損などのあらゆる不具合・不利益については一切の責任を負いかねますのでご了解ください。  
-このツールはすべてのMacintoshとMac OS上で動作をするという確認をとっていませんし、事実上出来ません。したがって、動作を保証するものではありません。  

## 履　歴  
2025-05-19	ver.0.1	とりあえず  

GYAHTEI Design Laboratory  
髙橋聡  
